<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Legendary: Game of Heroes deck suggester</title>
    <meta name="description" content="Legendary: Game of Heroes deck suggester">
    <meta name="author" content="Giero">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="css/style.css">

    <style type="text/css">
        .popover {
            color: #000
        }
    </style>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">
                Legendary: Game of Heroes - deck suggester
            </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul id="page-nav" class="nav navbar-nav pull-right">
                <li role="presentation" class="active"><a href="#team">Your team</a></li>
                <li role="presentation"><a href="#decks">Suggested decks</a></li>
                <li role="presentation"><a href="#heroes">List of heroes</a></li>
                <li role="presentation"><a href="#contact">Contact</a></li>
            </ul>
        </div>
    </div>
</nav>

<div id="app" class="container" role="main">
    <div class="row">
        <div class="tab-content" id="page-content">
            <div class="tab-pane fade active in" role="tabpanel" id="team">
                <team-adding-form></team-adding-form>
                <team-heroes-list></team-heroes-list>
            </div>
            <div class="tab-pane fade" role="tabpanel" id="decks">
                <computed-decks></computed-decks>
            </div>
            <div class="tab-pane fade" role="tabpanel" id="heroes">
                <p class="bg-danger" style="padding: 15px">
                    This list is based on <strong><a href="https://goo.gl/e2ql9O">this spreadsheet</a></strong> - feel free to update it, if something is missing.
                </p>
                <all-heroes-list></all-heroes-list>
            </div>
            <div class="tab-pane fade" role="tabpanel" id="contact">
                <p>Soon ;)</p>
            </div>
        </div>
    </div>
</div>

<template id="heroes-list">
    <section>
        <div>
            <ul :id="listId" class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a :href="'#' + listId + '-fire'">Fire ({{ counter.fire }})</a></li>
                <li role="presentation"><a :href="'#' + listId + '-water'">Water ({{ counter.water }})</a></li>
                <li role="presentation"><a :href="'#' + listId + '-earth'">Earth ({{ counter.earth }})</a></li>
                <li role="presentation"><a :href="'#' + listId + '-light'">Light ({{ counter.light }})</a></li>
                <li role="presentation"><a :href="'#' + listId + '-dark'">Dark ({{ counter.dark }})</a></li>
                <li role="presentation"><a :href="'#' + listId + '-all'">All ({{ counter.all }})</a></li>
            </ul>
        </div>

        <div class="tab-content" :id="listId + '-content'">
            <div class="tab-pane fade active in" role="tabpanel" :id="listId + '-fire'">
                <heroes-table affinity="Fire"></heroes-table>
            </div>
            <div class="tab-pane fade" role="tabpanel" :id="listId + '-water'">
                <heroes-table affinity="Water"></heroes-table>
            </div>
            <div class="tab-pane fade" role="tabpanel" :id="listId + '-earth'">
                <heroes-table affinity="Earth"></heroes-table>
            </div>
            <div class="tab-pane fade" role="tabpanel" :id="listId + '-light'">
                <heroes-table affinity="Light"></heroes-table>
            </div>
            <div class="tab-pane fade" role="tabpanel" :id="listId + '-dark'">
                <heroes-table affinity="Dark"></heroes-table>
            </div>
            <div class="tab-pane fade" role="tabpanel" :id="listId + '-all'">
                <heroes-table></heroes-table>
            </div>
        </div>
    </section>
</template>

<template id="heroes-table">
    <section>
        <div class="filters row">
            <div class="form-group col-sm-3">
                <label for="search-element">Hero name</label>
                <input v-model="searchKey" class="form-control" id="search-element" />
            </div>
        </div>

        <table class="table">
            <thead>
            <tr>
                <th>Name</th>
                <th>Attack</th>
                <th>Recovery</th>
                <th>Health</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="hero in filteredHeroes">
                <td v-html="$options.filters.staredName(hero.name, hero.rarity)"></td>
                <td>{{ hero.attack }}</td>
                <td>{{ hero.recovery }}</td>
                <td>{{ hero.health }}</td>
                <td><span class="glyphicon glyphicon-remove text-danger" style="cursor: pointer;" :data-hero-id="hero.id" @click="removeHeroFromList"></span></td>
            </tr>
            </tbody>
        </table>
    </section>
</template>

<template id="team-adding-form">
    <div class="jumbotron">
        <form id="team-adding" role="form" method="post" class="form-horizontal" @submit="addHeroToTeam">
            <fieldset>
                <legend>Add hero to team</legend>
                <div class='form-group'>
                    <div class='col-sm-12'>
                        <select class="form-control selectpicker" id="team-hero-id" name="id" required title="Hero name" data-live-search="true">
                            <optgroup v-for="affinity in affinities" :label="affinity">
                                <option v-for="hero in heroes" v-if="hero.affinity == affinity" :value="hero.id"
                                        :data-content="hero.name|staredName(hero.rarity)"
                                >{{ hero.name }}
                                </option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="team-hero-attack" name="attack" required placeholder="Attack"/>
                    </div>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="team-hero-recovery" name="recovery" required placeholder="Recovery"/>
                    </div>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="team-hero-health" name="health" required placeholder="Health"/>
                    </div>
                </div>
                <button id="add-to-team" class="btn btn-primary">Add to team</button>
                <button id="add-random-to-team" @click="addRandomHeroToTeam" class="btn btn-primary" title="Press Shift to add 10 heroes at once">
                    Add random hero to team (for tests)
                </button>
                <button id="clear-team" @click="clearTeam" class="btn btn-danger pull-right">Clear your team</button>
            </fieldset>
        </form>
    </div>
</template>

<template id="computed-decks">
    <section class="container">
        <div class="row">
            <div v-show="teamHeroes.heroes.length < 5">
                <span>Add some more heroes to your team</span>
            </div>
            <div v-show="teamHeroes.heroes.length >= 5" class="row" style="display: flex; align-items: center">
                <div class="col-sm-5">
                    <button id="calculate-decks" class="btn btn-primary" @click="calculateDecks">
                        <span>Calculate decks</span>
                        <br />
                        <small>(possible {{ possibilities.format(0, 3) }} decks in {{ (possibilities*5).format(0, 3) }} configurations (for every affinity))</small>
                    </button>
                    <button id="stop-calculations" style="display: none" class="btn btn-danger" @click="stopCalculations">Stop calculations</button>
                </div>

                <div class="col-sm-7">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Calculation options</h3>
                        </div>
                        <div class="panel-body">
                            <label for="calculation-event-type">Enable event:</label>
                            <select id="calculation-event-type" class="selectpicker" v-model="event">
                                <option value="">None</option>
                                <option value="Slayer">Slayer</option>
                                <option value="Commander">Commander</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <hr />
            <div v-if="progress > -1" class="progress">
                <div class="progress-bar progress-bar-striped" role="progressbar" :style="'width: ' + progress + '%'">
                    {{ progress }}%
                </div>
            </div>
        </div>

        <div class="row panel panel-default" v-for="(decksByStat, affinity) in bestDecks">
            <div class="panel-heading">Against: {{ affinity }}</div>

            <div class="panel panel-body">
                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" :class="stat == 'attack' ? 'active' : ''" v-for="(deck, stat) in decksByStat">
                        <a :href="'#computed-' + affinity + '-' + stat" role="tab" data-toggle="tab">
                            {{ stat }} (score: {{ deck.value.format(0, 3) }})
                            <span class="glyphicon glyphicon-info-sign text-info"
                                  data-toggle="popover"
                                  data-trigger="hover"
                                  data-placement="top"
                                  data-container="body"
                                  :data-content="'Sum of all heroes \'' + stat + '\' stats after all bonuses are applied'"></span>
                        </a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane fade" :class="stat == 'attack' ? 'in active' : ''"
                         :id="'computed-' + affinity + '-' + stat" v-for="(deck, stat) in decksByStat">

                        <ul>
                            <li v-for="(hero, key) in deck.heroes">
                            <span :class="key === 0 ? 'text-danger': ''">
                                <span v-html="$options.filters.staredName(hero.name, hero.rarity)"></span>
                                ({{ hero.affinity }} {{ hero.type }} {{ hero.species }}
                                :: {{ hero.attack }}/{{ hero.recovery }}/{{ hero.health }})
                                <span v-if="Object.keys(hero.eventSkills).length !== 0">
                                    <span v-if="hero.eventSkills.hasOwnProperty('Slayer')">
                                        :: Slayer {{ hero.eventSkills.Slayer }}x
                                    </span>
                                    <span v-if="hero.eventSkills.hasOwnProperty('Commander')">
                                        :: {{ hero.affinity }} Commander {{ hero.eventSkills.Commander }}x
                                    </span>
                                </span>
                            </span>
                            <span v-if="key === 0"
                                  class="glyphicon glyphicon-info-sign text-info"
                                  data-toggle="popover"
                                  data-trigger="hover"
                                  :title="hero.leaderAbility.name"
                                  :data-content="hero.leaderAbility.description"></span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
</template>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-rating-input/0.4.0/bootstrap-rating-input.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/vue/2.3.3/vue.js"></script>

<script src="js/hero.js"></script>
<script src="js/team.js"></script>
<script src="js/deck.js"></script>
<script src="js/deck_generator.js"></script>
<script src="js/deck_worker.js"></script>
<script src="js/main.js"></script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-99018598-1', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>
